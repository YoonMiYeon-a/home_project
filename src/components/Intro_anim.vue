<template>
  <section class="about">
    <div class="intro_crossboard">
      <p class="scale-txt">SYSTEM GROUP</p>
      <span class="scroll_rolling">SCROLL DOWN</span>
      <div class="crossboard_wrap system-on">
        <div class="crossboard_title">
          <p>WE</p>
          <p>ARE</p>
        </div>
        <div class="crossboard_main">
          <div class="img_txt_wrap">
            <img src="../assets/images/visual/system_txt.png" alt="SYSTEM" />
            <img
              src="../assets/images/visual/creative_txt.png"
              alt="CREATIVE"
            />
          </div>
          <div class="group_txt_wrap">
            <img
              class="group_txt_img"
              src="../assets/images/visual/Group_txt.png"
              alt="Group"
            />
            <div class="system_mark_wrap">
              <span></span>
              <span></span>
              <span></span>
              <span></span>
            </div>
            <div class="jt_mark_wrap">
              <!--?xml version="1.0" encoding="UTF-8"?-->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 79 79"
                class="jt_mark_svg"
                width="79px"
                height="79px"
              >
                <defs></defs>
                <path class="cls-1 TpwDlFpr_0" d="M39.5,39.5L39.5,0"></path>
                <path class="cls-1 TpwDlFpr_1" d="M39.5,39.5L19.75,5.29"></path>
                <path class="cls-1 TpwDlFpr_2" d="M39.5,39.5L5.29,19.75"></path>
                <path class="cls-1 TpwDlFpr_3" d="M39.5,39.5L0,39.5"></path>
                <path class="cls-1 TpwDlFpr_4" d="M39.5,39.5L5.29,59.25"></path>
                <path
                  class="cls-1 TpwDlFpr_5"
                  d="M39.5,39.5L19.75,73.71"
                ></path>
                <path class="cls-1 TpwDlFpr_6" d="M39.5,39.5L39.5,79"></path>
                <path
                  class="cls-1 TpwDlFpr_7"
                  d="M39.5,39.5L59.25,73.71"
                ></path>
                <path
                  class="cls-1 TpwDlFpr_8"
                  d="M39.5,39.5L73.71,59.25"
                ></path>
                <path class="cls-1 TpwDlFpr_9" d="M39.5,39.5L79,39.5"></path>
                <path
                  class="cls-1 TpwDlFpr_10"
                  d="M39.5,39.5L73.71,19.75"
                ></path>
                <path
                  class="cls-1 TpwDlFpr_11"
                  d="M39.5,39.5L59.25,5.29"
                ></path>
              </svg>
            </div>
          </div>
        </div>
        <div class="cross_link">
          <a href="#"><strong>NURIER</strong>SYSTEM</a>
          <a href="#"><strong>NURIER</strong>JT</a>
        </div>
        <svg
          width="179"
          height="257"
          viewBox="0 0 179 257"
          fill="none"
          class="arrow_svg1"
        >
          <path
            d="M175 6.12961C160.666 4.6158 147.064 2.80814 132.736 5.06059C115.667 7.74392 99.3199 13.0454 84.0576 21.1721C75.1626 25.9084 69.6555 30.8142 65.3881 39.918C61.1784 48.8986 59.1245 57.8953 58.974 67.8269C58.87 74.689 58.8232 84.4048 63.7082 89.9325C66.8522 93.4903 74.9326 92.2606 78.2544 89.5507C82.2349 86.3035 75.0596 81.2334 72.9475 79.7387C69.1124 77.0247 66.1102 75.22 61.3411 75.6536C54.5597 76.2701 48.5292 79.341 42.9006 83.0221C34.7916 88.3255 25.9094 94.4488 20.6804 102.799C8.94246 121.543 2.82656 144.715 4.18712 166.711C5.21903 183.393 10.2002 196.297 23.6584 206.493C32.2149 212.975 68.5 242 80.5 245"
            stroke="white"
            stroke-width="8"
            stroke-linecap="round"
            class="HoKbnvpt_0"
          ></path>
          <path
            d="M51 245.74C59.5203 250 69.8958 249.88 79.0998 251.925C83.6828 252.943 83.9867 253.998 83.9867 248.756C83.9867 239.475 83.2994 230.115 83.2994 221"
            stroke="white"
            stroke-width="8"
            stroke-linecap="round"
            class="HoKbnvpt_1"
          ></path>
        </svg>
        <svg
          width="120"
          height="109"
          viewBox="0 0 125 107"
          fill="none"
          class="arrow_svg2"
        >
          <path
            d="M39.0283 5.60974C39.0283 13.3703 41.2001 20.6721 41.2001 28.4424C41.2001 36.9125 43.9148 44.8713 43.9148 53.3615"
            stroke="white"
            stroke-width="8"
            stroke-linecap="round"
            class="UTIwkhve_0"
          ></path>
          <path
            d="M87.3513 4.00012C85.7499 7.16515 85.1272 11.8683 84.6667 15.3568C83.6554 23.0186 81.3789 30.8023 81.3789 38.5173C81.3789 42.5712 81.3789 46.625 81.3789 50.6788"
            stroke="white"
            stroke-width="8"
            stroke-linecap="round"
            class="UTIwkhve_1"
          ></path>
          <path
            d="M4.22852 50.2091C8.14848 58.6916 15.4806 63.9229 22.837 69.3323C26.4928 72.0205 29.3874 74.919 32.368 78.2758C34.6187 80.8107 37.4174 82.6807 39.7063 85.155C41.5918 87.1932 44.2189 89.2103 46.407 90.9574C49.6984 93.5853 51.6831 97.4167 55.0762 99.9277C56.4233 100.925 58.1446 102.73 59.9606 102.611C66.0387 102.215 70.71 97.8352 75.3849 94.5432C80.7111 90.7925 86.5812 88.2166 91.3686 83.7018C95.2358 80.0547 99.1853 76.5228 103.067 72.9042C106.847 69.3804 109.269 64.3741 112.782 60.4994C115.412 57.5979 117.692 54.1357 120.647 51.629"
            stroke="white"
            stroke-width="8"
            stroke-linecap="round"
            class="UTIwkhve_2"
          ></path>
        </svg>
      </div>
    </div>
  </section>
</template>

<script>
import { gsap } from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";

gsap.registerPlugin(ScrollTrigger);

export default {
  mounted() {
    gsap.set(".wrapper", { xPercent: -40, yPercent: -30 });
    // gsap.set("#no01", { y: 244 });
    // gsap.set("#no02", { y: 728 });
    gsap.set("#no03", { y: 160 });
    gsap.set("#no04", { y: 679 });

    const springAnim = gsap.timeline();

    springAnim.to(
      ".system_mark_wrap span:nth-child(1)",
      { y: -10, yoyo: true, repeat: -1, ease: "Power1.easeInOut", duration: 1 },
      "+=0.6"
    );
    springAnim.to(
      ".system_mark_wrap span:nth-child(2)",
      { y: -5, yoyo: true, repeat: -1, ease: "Power1.easeInOut", duration: 1 },
      "+0.6"
    );
    springAnim.to(
      ".system_mark_wrap span:nth-child(3)",
      { y: 5, yoyo: true, repeat: -1, ease: "Power1.easeInOut", duration: 1 },
      "+0.6"
    );
    springAnim.to(
      ".system_mark_wrap span:nth-child(4)",
      { y: 10, yoyo: true, repeat: -1, ease: "Power1.easeInOut", duration: 1 },
      "+0.6"
    );

    var boxWidth = 1626,
      totalWidth = boxWidth * 3, //  * n of boxes
      // no01 = document.querySelectorAll("#no01 .box"),
      // no02 = document.querySelectorAll("#no02 .box"),
      no03 = document.querySelector("#no03 .box"),
      no04 = document.querySelector("#no04 .box"),
      dirFromLeft = "+=" + totalWidth,
      dirFromRight = "-=" + totalWidth;

    var mod = gsap.utils.wrap(0, totalWidth);

    function marquee(which, time, direction, repeat) {
      gsap.set(which, {
        x: function (i) {
          return i * boxWidth;
        },
      });
      var action = gsap.timeline().to(which, {
        x: direction,
        modifiers: {
          x: (x) => mod(parseFloat(x)) + "px",
        },
        duration: time,
        ease: "none",
        repeat: repeat,
      });
      return action;
    }

    // function introIsol() {
    //   var introIsol = gsap.timeline();
    //   var lineSpans = []; // lineSpans 변수를 배열로 선언

    //   document.addEventListener("DOMContentLoaded", function () {
    //     var text = document.querySelector(".title_wrap");

    //     var lines = [
    //       "Online Financial Total",
    //       "Service Realization",
    //       "Specialist Group",
    //     ];

    //     var lineContainerWrap = document.createElement("div");
    //     lineContainerWrap.classList.add("line-container-wrap");

    //     lines.forEach(function (line) {
    //       var lineContainer = document.createElement("div");
    //       lineContainer.classList.add("line-container");

    //       var letters = Array.from(line);
    //       var lineSpansTemp = [];
    //       letters.forEach(function (letter) {
    //         var span = document.createElement("span");
    //         span.textContent = letter;
    //         if (letter !== " ") {
    //           span.classList.add("letter");
    //         } else {
    //           span.classList.add("letter");
    //           span.classList.add("space");
    //         }
    //         lineContainer.appendChild(span);
    //         lineSpansTemp.push(span);
    //       });

    //       var lineBreak = document.createElement("br");
    //       lineContainer.appendChild(lineBreak);

    //       lineContainerWrap.appendChild(lineContainer);

    //       lineSpans = lineSpans.concat(lineSpansTemp); // lineSpans 배열에 임시 배열 요소 추가
    //     });

    //     const subText = document.querySelectorAll(".sub_title_wrap p");
    //     introIsol.to("body", { overflow: "hidden" });
    //     introIsol.fromTo(
    //       lineSpans,
    //       { opacity: 0, y: 30 },
    //       { opacity: 1, y: 0, stagger: 0.05 }
    //     );
    //     introIsol.fromTo(
    //       subText,
    //       { opacity: 0, x: 30 },
    //       { opacity: 1, x: 0, stagger: 0.05 }
    //     );
    //     introIsol.to(lineSpans, {
    //       opacity: 0,
    //       x: -30,
    //       delay: 1,
    //       stagger: 0.01,
    //     });
    //     introIsol.to(subText, { opacity: 0, x: -30, stagger: 0.01 }, "-=0.5");
    //     introIsol.to("body", { overflowY: "auto" });
    //     text.appendChild(lineContainerWrap);
    //   });

    //   return introIsol;
    // }

    function introScene() {
      const about = document.querySelector(".about");
      const scaleTxt = document.querySelector(".intro_crossboard p");
      const crossboardWrap = document.querySelector(".crossboard_wrap");

      var introScene = gsap.timeline();
      // eslint-disable-next-line no-unused-vars
      let marquee3;
      // eslint-disable-next-line no-unused-vars
      let marquee4;
      introScene
        .to(scaleTxt, { opacity: 1 })
        .to(scaleTxt, { scale: 200, duration: 5 })
        .to(scaleTxt, { scale: 25 })
        .to(scaleTxt, { opacity: 0 });
      introScene.fromTo(
        ".crossboard_title p",
        { x: 300, opacity: 0 },
        { x: 0, opacity: 1 }
      );
      introScene.add(() => {
        marquee3 = marquee(no03, 7, dirFromLeft, -1);
        marquee4 = marquee(no04, 7, dirFromRight, -1);
      });
      introScene.fromTo(
        ".img_txt_wrap",
        { x: 300, opacity: 0 },
        { x: 0, opacity: 1 }
      );
      introScene.fromTo(
        ".group_txt_wrap",
        { x: 300, opacity: 0 },
        { x: 0, opacity: 1 }
      );
      introScene.fromTo(
        ".system_mark_wrap",
        { opacity: 0 },
        { opacity: 1 },
        "+=0.1"
      );
      introScene.fromTo(
        ".system_mark_wrap span",
        { opacity: 0, x: 20 },
        { opacity: 1, x: 0, stagger: 0.2 },
        "start"
      );
      introScene.add(() => {
        springAnim.play(); // springAnim 실행
      });

      introScene.to(".cross_link a:first-child", { display: "block" });
      introScene.fromTo(
        ".cross_link a:first-child",
        { y: 50, opacity: 0 },
        { y: 0, opacity: 1 }
      );
      introScene.to(".arrow_svg1", { display: "block", duration: 6 });
      introScene.to(".arrow_svg1", { opacity: 0 }, "-=0.6");
      introScene.to(".arrow_svg1", { display: "none" });
      introScene.to(".crossboard_main", { opacity: 0 });
      introScene.to(".system_mark_wrap", { opacity: 0 });
      introScene.to(".system_mark_wrap span", { opacity: 0 });
      introScene.to(".cross_link a:first-child", { opacity: 0 });
      introScene.to(".cross_link a:first-child", { display: "none" });

      introScene.fromTo(".system_mark_wrap", { opacity: 0 }, { opacity: 1 });
      introScene.fromTo(".jt_mark_wrap", { opacity: 0 }, { opacity: 1 });
      introScene.add(() => {
        crossboardWrap.classList.toggle("system-on");
        crossboardWrap.classList.toggle("jt-on");
        no03.classList.toggle("system-on");
        no03.classList.toggle("jt-on");
        no04.classList.toggle("system-on");
        no04.classList.toggle("jt-on");
      });
      introScene.to(".crossboard_main", { opacity: 1 });
      introScene.to(no03, { opacity: 0, duration: 2 });
      introScene.to(no03, { display: "none" });

      introScene
        .to(".jt_mark_svg", { display: "block" })
        .to(".cross_link a:last-child", { opacity: 1, duration: 1 })
        .to(".arrow_svg2", { display: "block", duration: 3 });

      ScrollTrigger.create({
        trigger: about,
        pin: true,
        start: "top top",
        end: "bottom -1000%",
        scrub: true,
        animation: introScene,
      });
      return introScene;
    }

    var master = gsap.timeline();
    master.play();
    master
      // .add(introIsol())
      // .add(function () {
      //   var marquee1 = marquee(no01, 4, dirFromRight, 0);
      //   var marquee2 = marquee(no02, 4, dirFromLeft, 0);
      //   master.add([
      //     marquee1.delay(introIsol().endTime()),
      //     marquee2.delay(introIsol().endTime()),
      //   ]);
      // })
      .add(introScene());

    return {
      marquee,
      // introIsol,
      introScene,
      master,
    };
  },
};
</script>

<style>
@import "../assets/css/svg.css";
@import "../assets/css/intro_common.css";
</style>
